unbind C-b
unbind c
set -g prefix C-t
set -g mouse on

set -sg escape-time 0
set -g popup-border-lines rounded

#set inactive/active window styles
# set -g window-style 'fg=default,bg=default'
# set -g window-active-style 'fg=default,bg=#222222'
# set -g pane-border-style 'fg=default,bg=default' 
# set -g pane-active-border-style 'fg=default,bg=#222222'

bind 'V' copy-mode
bind -n C-k clear-history



# Vim Tmux Navigation
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind-key n if-shell "$is_vim" 'send-keys C-t n' 'select-pane -L'
bind-key i if-shell "$is_vim" 'send-keys C-t i' 'select-pane -R'
bind-key e if-shell "$is_vim" 'send-keys C-t e' 'select-pane -D'
bind-key u if-shell "$is_vim" 'send-keys C-t u' 'select-pane -U'
bind-key -T copy-mode-vi n select-pane -L
bind-key -T copy-mode-vi e select-pane -D
bind-key -T copy-mode-vi u select-pane -U
bind-key -T copy-mode-vi i select-pane -R

bind y kill-pane 
bind o new-window
bind a new-session
bind-key r command-prompt "rename-window '%%'"

# splits
bind h split-window -h -c "#{pane_current_path}"
bind b split-window -v -c "#{pane_current_path}"
bind-key "'" split-window -h -b -p 30

# clear view
bind-key t send-keys -R \; clear-history \; send-keys "clear" \; send-keys "Enter" 

# switch to session
bind m display-popup -E "\
    tmux list-sessions -F '#{?session_attached,,#{session_name}}' |\
    sed '/^$/d' |\
    fzf --reverse --border=none --header jump-to-session --preview 'tmux capture-pane -pt {}'  |\
    xargs tmux switch-client -t"

# open project
bind O display-popup -E "~/scripts/tmux_helpers/open_project.sh `ls ~/projects | fzf --reverse --border=none
--header 'Jump to project'`"

bind k display-popup -w 80% -h 80% -E 'cwd=$(tmux display-message -p "#{pane_current_path}"); lazygit -p $cwd'
bind N display-popup -w 50% -h 30% -E 'cwd=$(tmux display-message -p "#{pane_current_path}"); cd $cwd; trun'

# bind p display-popup -E "\
# PROJECT=`ls ~/projects | fzf-tmux -p --reverse`; echo $PROJECT"

# switch to window 
bind f display-popup -E " \
    tmux list-windows -F '#{window_name}' |\
    sed '/^$/d' |\
    fzf --reverse --border=none --header 'Select window:' --preview 'tmux capture-pane -pt {}'  |\
    xargs tmux select-window -t"

bind -n C-u next-window
bind -n C-n previous-window
# bind -n C-k display-popup -w 80 -E 'lazygit'

# bind-key -T prefix v switch-client -T prefix_v
# bind-key -T prefix_v n split-window -h
# bind-key -T prefix_v i split-window -v

set -g @plugin 'tmux-plugins/tpm/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'dracula/tmux'

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'github_username/plugin_name#branch'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'

# Config Dracula Theme
# available plugins: battery, cpu-usage, git, gpu-usage, ram-usage, network, network-bandwidth, network-ping, weather, time

# set -g @dracula-plugins "time"
set -g @dracula-time-colors "gray orange"
set -g @dracula-show-powerline true
set -g @dracula-show-left-icon "âš¡"
set -g @dracula-military-time true
set -g @dracula-refresh-rate 5
set -g status-position top


run '~/.tmux/plugins/tpm/tpm'

set -g status-right-length 100
set -g status-right '#(~/personal_projects/dotfiles/tmux/status.sh):#(date +"%I:%M")'
